@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đặt vé xem phim</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
    <link rel="stylesheet" href="~/css/Movie.css">
    <link href="~/css/darkmode.css" rel="stylesheet" />
    <link href="~/css/lightmode.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" />

</head>
<body>
    <!-- Tìm kiếm -->
    <div class="search-container d-flex justify-content-center mt-3 mb-4">
        <div class="input-group w-50">
            <input type="text" id="SearchProduct" class="form-control" placeholder="@Localizer["SearchPlaceholder"]" autocomplete="on" />
            <button id="searchButton" class="btn btn-primary">🔍 @Localizer["Search"]</button>
        </div>
    </div>

    <div class="container">
        <!-- Banner -->
        <div class="mb-5">
            <div id="imageSlider" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner rounded">
                    @{
                        bool firstItem = true;
                        foreach (var item in Model)
                        {
                            <div class="carousel-item @(firstItem ? "active" : "")">
                                <img src="@item.BannerUrl" class="d-block w-100" alt="@item.Title" />
                            </div>
                            firstItem = false;
                        }
                    }
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#imageSlider" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#imageSlider" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                </button>
            </div>
        </div>

        <!-- Swiper -->
        <h2 class="text-center mb-4">@Localizer["NowShowing"]</h2>
        <div class="swiper movie-swiper">
            <div class="swiper-wrapper">
                @foreach (var item in Model)
                {
                    <div class="swiper-slide">
                        <div class="card shadow-sm h-100 position-relative">
                            <img src="@item.PosterUrl" class="card-img-top" alt="@item.Title" />
                            @if (item.HasShowtime)
                            {
                                <span class="badge bg-success position-absolute top-0 start-0 m-2">@Localizer["Showtime"]</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary position-absolute top-0 start-0 m-2">@Localizer["NoShowtime"]</span>

                            }
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">@item.Title</h5>
                                <p class="card-text">
                                    <small><i class="fas fa-clock"></i> @item.Duration @Localizer["Minutes"]</small>
                                </p>
                                <a asp-controller="Movie" asp-action="Details" asp-route-id="@item.Id" class="btn btn-primary mt-auto">
                                    @Localizer["Details"]
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>

    <script>
        // Autocomplete tìm kiếm
        $(function () {
            $("#SearchProduct").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/Movie/Search",
                        type: "GET",
                        data: { term: request.term },
                        success: function (data) {
                            response($.map(data, function (item) {
                                return {
                                    label: item.label,
                                    value: item.label,
                                    id: item.value
                                };
                            }));
                        }
                    });
                },
                minLength: 1,
                select: function (event, ui) {
                    window.location.href = "/Movie/Details/" + ui.item.id;
                }
            });

            $("#searchButton").click(function () {
                var term = $("#SearchProduct").val();
                if (term.length > 0) {
                    $.get("/Movie/Search", { term: term }, function (data) {
                        if (data.length > 0) {
                            window.location.href = "/Movie/Details/" + data[0].value;
                        } else {
                            alert("@Localizer["NotFound"]");
                        }
                    });
                }
            });
        });

        // Swiper khởi tạo
        const swiper = new Swiper('.movie-swiper', {
            loop: true,
            slidesPerView: 1,
            spaceBetween: 10,
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            breakpoints: {
                768: { slidesPerView: 2, spaceBetween: 20 },
                1024: { slidesPerView: 4, spaceBetween: 30 }
            }
        });
    </script>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
        <script src="~/js/movie.js"></script>
        @section Scripts {
            <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
            <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" />
            <script>
                $(document).ready(function () {
                    // Autocomplete
                    $("#SearchProduct").autocomplete({
                        source: function (request, response) {
                            $.ajax({
                                url: "/Movie/Search",
                                type: "GET",
                                data: { term: request.term },
                                success: function (data) {
                                    response($.map(data, function (item) {
                                        return {
                                            label: item.label,
                                            value: item.label,
                                            id: item.value
                                        };
                                    }));
                                }
                            });
                        },
                        minLength: 1,
                        select: function (event, ui) {
                            window.location.href = "/Movie/Details/" + ui.item.id;
                        }
                    });

                    // Bấm nút Search
                    $("#searchButton").on("click", function () {
                        var term = $("#SearchProduct").val();
                        if (term.length > 0) {
                            $.get("/Movie/Search", { term: term }, function (data) {
                                if (data.length > 0) {
                                    window.location.href = "/Movie/Details/" + data[0].value;
                                } else {
                                    alert("@Localizer["NotFound"]");
                                }
                            });
                        }
                    });
                });
            </script>
        }
</body>
</html>