@model IEnumerable<CineTicket.Models.Ticket>

@{
    ViewData["Title"] = "Danh sách vé";
}

<h1 class="text-dark mb-3">@ViewData["Title"]</h1>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}
@* <a asp-action="Add" class="btn btn-primary mb-3"> *@
@*     <i class="bi bi-plus-lg"></i> Thêm vé *@
@* </a> *@
<a asp-action="DeleteAll" class="btn btn-danger mb-3 ms-2"
   onclick="return confirm('Bạn có chắc muốn xoá tất cả vé không?')">
    <i class="bi bi-trash3"></i> Xoá tất cả vé
</a>

<div class="table-responsive">
    <table id="ticketsTable" class="table table-hover table-bordered table-striped text-light align-middle" style="width:100%">
        <thead class="table-secondary text-dark">
            <tr>
                <th>Phim / Suất</th>
                <th>Thời gian đặt</th>

                <th>Ghế</th>
                <th>Giá</th>
                <th>Người đặt</th>
                <th class="text-center" style="width:140px">Thao tác</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var t in Model)
            {
                <tr>
                    <td>
                        @t.Showtimes?.Movie?.Title <br />
                        <small class="text-muted">
                            @t.Showtimes?.StartTime.ToString("dd/MM/yyyy HH:mm")
                        </small>
                    </td>
                    <td>@t.BookingTime.ToString("dd/MM/yyyy HH:mm")</td>

                    <td>@t.SeatNumber</td>
                    <td>@t.Price.ToString("N0") đ</td>
                    <td>@t.User?.Email</td>
                    <td class="text-center">
                        <a asp-action="Edit" asp-route-id="@t.Id" class="btn btn-sm btn-warning me-1">Sửa</a>
                        <a asp-action="Delete" asp-route-id="@t.Id" class="btn btn-sm btn-danger"
                           onclick="return confirm('Xoá vé này?')">Xoá</a>

                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
@section Scripts {
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#ticketsTable').DataTable({
                pageLength: 10,
                lengthMenu: [5, 10, 25, 50],
                language: {
                    search: "🔍 Tìm kiếm:",
                    lengthMenu: "Hiển thị _MENU_ dòng",
                    info: "Đang xem _START_ đến _END_ trong _TOTAL_ mục",
                    infoEmpty: "Không có dữ liệu",
                    zeroRecords: "Không tìm thấy kết quả phù hợp",
                    paginate: {
                        previous: "Trước",
                        next: "Sau"
                    }
                },
                responsive: true
            });
        });
    </script>
}
